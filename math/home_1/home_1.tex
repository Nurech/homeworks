\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[sfdefault,ultralight]{FiraSans} %% option 'sfdefault' activates Fira Sans as the default text font
\usepackage[T1]{fontenc}
\renewcommand*\oldstylenums[1]{{\firaoldstyle #1}}
\usepackage{appendix}

\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{xcolor}
\usepackage{fdsymbol}
\usepackage{wasysym}
\usepackage{multicol}
\usepackage{amsmath,seqsplit}
\usepackage{algorithm, algorithmic}
\usepackage{tcolorbox}
\usepackage{geometry}
 \geometry{
 a4paper,
 right=20mm,
 left=25mm,
 top=25mm,
 bottom=25mm,
 }
\usepackage{pgfplots}
\usepackage{hyperref}
\usepackage{tikz}
\newcommand\foo[2]{%
    \begin{minipage}{#1}
    \seqsplit{#2}
    \end{minipage}
}

\setlength{\columnsep}{1cm}
\setlength\parindent{0pt}

\definecolor{pink}{RGB}{244,194,194}
\definecolor{green}{RGB}{143,188,143}
\definecolor{red}{RGB}{190,0,50}
\definecolor{ttgrey}{rgb}{0.58,0.59,0.69}
\definecolor{ttblue}{rgb}{0.2,0.17,0.38}
\definecolor{ttred}{rgb}{0.67,0.07,0.32}


\begin{document}

\begin{tcolorbox}[colframe=ttblue, colback=ttblue!10]
\begin{center}
\begin{large}
\textbf{First homework Joosep Parts 221963IVCM}
\end{large}
\end{center}
\end{tcolorbox}

\section*{Tasks}

\paragraph{Task 1.} Assume that the Affine cipher is implemented in $\mathbb{Z}_{97}$, not in $\mathbb{Z}_{26}$. (Imagine that we just
extended alphabet, added a set of special symbols. But the first 26 letters stay the same as in English alphabet.)\\

1. For this modified Affine cipher over \( \mathbb{Z}_{97} \), the encryption and decryption functions remain structurally the same but
adapt to the new modulo.

$$\text{Encryption: } Enc(m) = a\cdot m + b (\mod 97)$$
$$\text{Decryption: } Dec(c) = a^{-1}(c - b) (\mod 97)$$


2. To calculate the total number of keys, we need to consider the options for both \( a \) and \( b \) in the key \( k = (a, b) \).

Since 97 is a prime number, we use Euler's totient function to find the number of choices for \( a \):

\[
  \phi(97) = 97 - 1 = 96
\]

For the additive part \( b \), we have 97 choices, ranging from 0 to 96 inclusive:

\[
  \text{Choices for \( b \)} = 97
\]

Therefore, the total number of possible keys is:

\[
  \text{Total number of keys} = 96 \times 97 = 9312
\]


3. We read English alphabet and get numerical equivalents for B, U, H are 1, 20, and 7.
We do equations to solve for a and b.
To find the encryption and decryption keys, solve the following equations to find a and b.

\[
  \begin{aligned}
    81 &= a \cdot 1 + b \mod 97, \\
    71 &= a \cdot 20 + b \mod 97, \\
    37 &= a \cdot 7 + b \mod 97.
  \end{aligned}
\]

Solve for \( a \) and \( b \):

First, eliminate \( b \) by substituting it from the first equation into the third:

\[
  \begin{aligned}
    6a + 81 &\equiv 37 \mod 97, \\
    6a &\equiv -44 \mod 97, \\
    6a &\equiv 53 \mod 97.
  \end{aligned}
\]

Now, find the multiplicative inverse of 53 mod 97, which is \( a^{-1} = 66 \).

\[
  \begin{aligned}
    a &= 66 \cdot 53 \mod 97, \\
    a &= 25 \mod 97.
  \end{aligned}
\]

Finally, solve for \( b \) using the first equation:

\[
  \begin{aligned}
    b &= 81 - 25 \mod 97, \\
    b &= 56 \mod 97.
  \end{aligned}
\]

So, \( (a, b) = (25, 56) \mod 97 \).

Decrypting the Cipher goes with decryption, \( Dec = (a^{-1}, b) = (66, 56) \).

Decrypt \( c' = [59, 62, 90] \) using \( m' = a^{-1}(c' - b) \mod 97 \):

\[
  \begin{aligned}
    m'_1 &= 66 \cdot (59 - 56) \mod 97 = 66 \cdot 3 \mod 97 = 198 \mod 97 = 4, \\
    m'_2 &= 66 \cdot (62 - 56) \mod 97 = 66 \cdot 6 \mod 97 = 396 \mod 97 = 8, \\
    m'_3 &= 66 \cdot (90 - 56) \mod 97 = 66 \cdot 34 \mod 97 = 2244 \mod 97 = 13.
  \end{aligned}
\]

So, \( m' = [4, 8, 13] \), which corresponds to the airport code "EIN".



\paragraph{Task 2.} Look carefully at the following frequency diagrams.
\begin{enumerate}
    \item Well just like we did in class, by following the patterns and deducting possibility we could come to a 'certain' conclusion by
    analyzing the English alphabet frequency.
    \begin{enumerate}
            \item Figure 1: Diagram is identical to Diagram 3 this seems to correspond to a normal distribution, so I would say it
            represents plaintext .
            Distribution
            of Z, Q and J is >0.2 percent and letters such as E, T and A are most highest frequency.
            \item Figure 2: Diagram 2.
            This looks like plain text distribution however, in addition to shifting the frequencies have also
            changed places.
            So it affine cipher.
      \item Figure 3: Diagram 3 this seems to correspond to a normal distribution, so I would say it represents permutation as we already
            have one plaintext identified and permutation could look exactly like plaintext because it does not change frequency.
            Distribution
            of Z, Q and J is >0.2 percent and letters such as E, T and A are most highest frequency.
      \item Figure 4: Diagram 4 -  Vigen√®re cipher because the keyword causes letters to repeat in the ciphertext, which makes frequency
            more uniform, meaning, it's likely that the key was shorter than the message and letters start to repeat.
      \item Figure 5: Diagram 5 this is shift cipher locations of
            frequencies have changed locations but the order is same.
    \end{enumerate}
    \item
    \begin{minipage}{\linewidth}
          \begin{proof}
            \begin{align*}
              &\text{Let the plaintext alphabet be represented as } \mathcal{A} = \{A, B, \ldots, Z\}. \\
              &\text{Let the ciphertext alphabet be represented as } \mathcal{B} = \{A, B, \ldots, Z\}. \\
              &\text{Let the most frequent letter in the plaintext be 'E'.} \\
              &\text{Let the most frequent letter in the ciphertext be 'T'.} \\
              & \\
              &\text{According to Figure 1 or 3, in the plaintext, the most frequent letter is 'E'.} \\
              &\text{According to Figure 5, in the ciphertext, the most frequent letter is 'T'.} \\
              & \\
              &\text{If we consider 'A' to be 0 and 'Z' to be 25, then:} \\
              &E = 4, \quad T = 19 \\
              & \\
              &\text{The shift from 'E' to 'T' can be represented as:} \\
              &\text{Shift} = T - E \\
              &\text{Shift} = 19 - 4 \\
              &\text{Shift} = 15 \\
              & \\
              &\text{Therefore, the shift cipher has shifted the letters by 15 places.}
            \end{align*}
          \end{proof}
    \end{minipage}
\end{enumerate}


\paragraph{Task 3.} Assuming that the rate of the English language is \(1.8\), find the unicity distance of the affine cipher.

The unicity distance \( U \) for an affine cipher can be calculated using the formula:

\[
  U = \frac{K}{D}
\]

Where:
\begin{itemize}
  \item \( U \) is the unicity distance
  \item \( H(K) \) is the entropy of the key space
  \item \( D \) is the redundancy of the natural language (calculated as \( R - r \))
\end{itemize}
1) Rate and Redundancy:
For the English language, \( R = 4.7 \) absolute($\log_2 26$) and \( r = 1.8 \)(english rate), so redundancy (D) \( D = R - r = 4.7 - 1
.8 = 2.9 \).

2) Key Space:
For an affine cipher over an alphabet of size \( N \), the key space size \( M \) is \( N \times \phi(N) \), given that \( a \) (the multiplicative key) must be chosen such that \( \gcd(a, N) = 1 \).

For the English alphabet, \( N = 26 \) and Euler's totient function \( \phi(26) = 12 \).

Therefore, \( M = 26 \times 12 = 312 \).

3) Entropy of the Key Space:
The entropy of the key space \( K \) can be calculated as $M=$ \( \log_2 312 \approx 8.3 \).

4) Unicity Distance:
we get:

\[
  U = \frac{8.3}{2.9} \approx 2.86
\]

So the unicity distance \( U \) for an affine cipher with these parameters is approximately \(2.86\).
At least 3 characters is needed to try and attempt to break the cipher.


\paragraph{Task 4.} Suppose you intercepted the following ciphertext $c = 00010010 \quad 00000111 \quad 11101010$. You know that a
3-letter word was encrypted using one-time pad (to convert letters to binary strings ASCII table was used). Can you bruteforce keys and
learn the message that was encrypted?\\

No, bruteforcing keys in the case of a one-time pad is not possible. Because for me the key is truly random and it has been used one.
Even if I brute force and get some answer, I don't know if the message unencrypted is correct. Suppose 00010010 is ASCII code for letter
'A'. Even if I bruteforce with key 00010010 I would get back 'A', with 00010011 I would get something different etc. I could get up to 256
different plaintexts eventually, but for none of which I know to be true.



\paragraph{Task 5.}
You have intercepted the following ciphertext encrypted using Vigenere cipher. You have a cryptoanalyst friend who can help you break the cipher, but he asked you to \textbf{find key length}. \\

I use https://www.dcode.fr/index-coincidence to find the key length for $ctx$. Index of Coincidence on dCode.fr [online website], retrieved on 2023-09-24, https://www.dcode.fr/index-coincidence

I get the following results for $ctx$:

\begin{center}
  \begin{tikzpicture}
    \begin{axis}[
      width=\textwidth,
    ybar,
    xlabel={ctx},
    ylabel={IC},
    symbolic x coords={L=5, L=10, L=20, L=15, L=25, L=24, L=8, L=16, L=11, L=13, L=19, L=9, L=17, L=2, L=1, L=14, L=4, L=26, L=3, L=7, L=22, L=6, L=12, L=23, L=18, L=21},
    xtick=data,
    xticklabel style={rotate=45, anchor=east},
    ]
    \addplot coordinates {
      (L=5,0.05883) (L=10,0.05854) (L=20,0.05794) (L=15,0.05634) (L=25,0.05414)
      (L=24,0.04613) (L=8,0.04399) (L=16,0.0439) (L=11,0.04358) (L=13,0.04336)
      (L=19,0.04466) (L=9,0.04291) (L=17,0.04251) (L=2,0.04251) (L=1,0.04213)
      (L=14,0.04199) (L=4,0.04181) (L=26,0.04289) (L=3,0.04139) (L=7,0.04133)
      (L=22,0.04067) (L=6,0.04022) (L=12,0.03984) (L=23,0.03977) (L=18,0.03863)
      (L=21,0.03935)
    };
    \end{axis}
  \end{tikzpicture}
\end{center}

1) So it could be either lenght of 5, 10, 20, 15 or 25. Length of 5 being the highest.


\begin{table}[h]
  \centering
  \caption{Index of Coincidence for Different Key Lengths}
  \begin{tabular}{|c|c|}
    \hline
    \( N \) & \( \text{IC} \) \\
    \hline
    2 & 0.056706 \\
    3 & 0.050608 \\
    4 & 0.047559 \\
    5 & 0.04573 \\
    6 & 0.04451 \\
    7 & 0.043639 \\
    8 & 0.042986 \\
    9 & 0.042478 \\
    10 & 0.042133 \\
    11 & 0.041739 \\
    12 & 0.041461 \\
    13 & 0.041227 \\
    14 & 0.041026 \\
    15 & 0.040852 \\
    16 & 0.040699 \\
    17 & 0.040565 \\
    18 & 0.040445 \\
    19 & 0.040338 \\
    20 & 0.040242 \\
    21 & 0.040155 \\
    22 & 0.040076 \\
    23 & 0.040003 \\
    24 & 0.039937 \\
    25 & 0.039876 \\
    \hline
  \end{tabular}
\end{table}

2) If I exclude the very low end of number 0.03 and the high end 0.05 we can see that the majority of letters on average the IC for each
letter is slightly above 0.04 and the average is $ctx IC = 0.04213$, this leads me to believe that we can assume this Vigenere chipher is
with keyword length of $l=5$ with somewhat good confidence. (see index of confidence table)


\begin{figure}
  \centering
  \textbf{Plot for Y0}
  \begin{tikzpicture}
    \begin{axis}[
      width=\textwidth,
      ybar,
      xlabel={L},
      ylabel={IC},
      symbolic x coords={L=2, L=1, L=3, L=6, L=4, L=5, L=11, L=7, L=12, L=15, L=9, L=10, L=13, L=8, L=17, L=14, L=19, L=20, L=18, L=21, L=25, L=22, L=16, L=23, L=24, L=26},
      xtick=data,
      xticklabel style={rotate=45, anchor=east},
    ]
      \addplot coordinates {
        (L=2, 0.06504) (L=1, 0.06225) (L=3, 0.05996) (L=6, 0.05678) (L=4, 0.05595) (L=5, 0.05431) (L=11, 0.06277) (L=7, 0.04762) (L=12, 0.05159) (L=15, 0.05111) (L=9, 0.07901) (L=10, 0.05714) (L=13, 0.08278) (L=8, 0.06086) (L=17, 0.06471) (L=14, 0.04762) (L=19, 0.05263) (L=20, 0.035) (L=18, 0.07963) (L=21, 0.04762) (L=25, 0.02) (L=22, 0.03788) (L=16, 0.09167) (L=23, 0.06522) (L=24, 0.0625) (L=26, 0.10256)
      };
    \end{axis}
  \end{tikzpicture}
\end{figure}

\begin{figure}
  \centering
  \textbf{Plot for Y1}
  \begin{tikzpicture}
    \begin{axis}[
      width=\textwidth,
      ybar,
      xlabel={L},
      ylabel={IC},
      symbolic x coords={L=1, L=2, L=3, L=5, L=7, L=14, L=4, L=8, L=6, L=9, L=12, L=11, L=10, L=13, L=16, L=15, L=18, L=20, L=17, L=24, L=21, L=19, L=22, L=25, L=26, L=23},
      xtick=data,
      xticklabel style={rotate=45, anchor=east},
    ]
      \addplot coordinates {
        (L=1, 0.06053) (L=2, 0.05401) (L=3, 0.05379) (L=5, 0.05206) (L=7, 0.04978) (L=14, 0.05714) (L=4, 0.04643) (L=8, 0.04318) (L=6, 0.0348) (L=9, 0.07469) (L=12, 0.03175) (L=11, 0.09416) (L=10, 0.03214) (L=13, 0.06374) (L=16, 0.05208) (L=15, 0.06) (L=18, 0.05185) (L=20, 0.01833) (L=17, 0.04118) (L=24, 0.00694) (L=21, 0.03968) (L=19, 0.09123) (L=22, 0.06818) (L=25, 0.03333) (L=26, 0.05128) (L=23, 0.07971)
      };
    \end{axis}
  \end{tikzpicture}
\end{figure}

\begin{figure}
  \centering
  \textbf{Plot for Y2}
  \begin{tikzpicture}
    \begin{axis}[
      width=\textwidth,
      ybar,
      xlabel={L},
      ylabel={IC},
      symbolic x coords={L=4, L=1, L=2, L=3, L=8, L=7, L=9, L=6, L=5, L=11, L=16, L=10, L=13, L=14, L=18, L=12, L=19, L=17, L=15, L=25, L=21, L=23, L=22, L=24, L=26, L=20},
      xtick=data,
      xticklabel style={rotate=45, anchor=east},
    ]
      \addplot coordinates {
        (L=4, 0.06667) (L=1, 0.05823) (L=2, 0.05807) (L=3, 0.06085) (L=8, 0.07753) (L=7, 0.04978) (L=9, 0.06543) (L=6, 0.05128) (L=5, 0.05627) (L=11, 0.04762) (L=16, 0.06875) (L=10, 0.07341) (L=13, 0.06154) (L=14, 0.04762) (L=18, 0.04815) (L=12, 0.05952) (L=19, 0.04386) (L=17, 0.06275) (L=15, 0.05778) (L=25, 0.02) (L=21, 0.05556) (L=23, 0.04348) (L=22, 0.03788) (L=24, 0.07639) (L=26, 0.05769) (L=20, 0.10667)
      };
    \end{axis}
  \end{tikzpicture}
\end{figure}

\begin{figure}
  \centering
  \textbf{Plot for Y2}
  \begin{tikzpicture}
    \begin{axis}[
      width=\textwidth,
      ybar,
      xlabel={L},
      ylabel={IC},
      symbolic x coords={L=4, L=1, L=2, L=3, L=8, L=7, L=9, L=6, L=5, L=11, L=16, L=10, L=13, L=14, L=18, L=12, L=19, L=17, L=15, L=25, L=21, L=23, L=22, L=24, L=26, L=20},
      xtick=data,
      xticklabel style={rotate=45, anchor=east},
    ]
      \addplot coordinates {
        (L=4, 0.06667) (L=1, 0.05823) (L=2, 0.05807) (L=3, 0.06085) (L=8, 0.07753) (L=7, 0.04978) (L=9, 0.06543) (L=6, 0.05128) (L=5, 0.05627) (L=11, 0.04762) (L=16, 0.06875) (L=10, 0.07341) (L=13, 0.06154) (L=14, 0.04762) (L=18, 0.04815) (L=12, 0.05952) (L=19, 0.04386) (L=17, 0.06275) (L=15, 0.05778) (L=25, 0.02) (L=21, 0.05556) (L=23, 0.04348) (L=22, 0.03788) (L=24, 0.07639) (L=26, 0.05769) (L=20, 0.10667)
      };
    \end{axis}
  \end{tikzpicture}
\end{figure}

\begin{figure}
  \centering
  \textbf{Plot for Y3}
  \begin{tikzpicture}
    \begin{axis}[
      width=\textwidth,
      ybar,
      xlabel={L},
      ylabel={IC},
      symbolic x coords={L=1, L=2, L=3, L=4, L=5, L=6, L=8, L=7, L=12, L=10, L=11, L=9, L=13, L=14, L=15, L=17, L=18, L=16, L=22, L=21, L=23, L=26, L=19, L=20, L=24, L=25},
      xtick=data,
      xticklabel style={rotate=45, anchor=east},
    ]
      \addplot coordinates {
        (L=1, 0.05789) (L=2, 0.05787) (L=3, 0.05759) (L=4, 0.05902) (L=5, 0.05902) (L=6, 0.05403) (L=8, 0.06288) (L=7, 0.06667) (L=12, 0.06111) (L=10, 0.05675) (L=11, 0.06494) (L=9, 0.05802) (L=13, 0.0315) (L=14, 0.07143) (L=15, 0.05333) (L=17, 0.06863) (L=18, 0.04444) (L=16, 0.0625) (L=22, 0.04545) (L=21, 0.05556) (L=23, 0.04348) (L=26, 0.03205) (L=19, 0.06316) (L=20, 0.04167) (L=24, 0.07639) (L=25, 0.06667)
      };
    \end{axis}
  \end{tikzpicture}
\end{figure}

\begin{figure}
  \centering
  \textbf{Plot for Y4}
  \begin{tikzpicture}
    \begin{axis}[
      width=\textwidth,
      ybar,
      xlabel={L},
      ylabel={IC},
      symbolic x coords={L=2, L=7, L=1, L=4, L=3, L=5, L=8, L=9, L=6, L=10, L=13, L=11, L=15, L=14, L=12, L=16, L=17, L=20, L=21, L=19, L=18, L=23, L=25, L=22, L=26, L=24},
      xtick=data,
      xticklabel style={rotate=45, anchor=east},
    ]
      \addplot coordinates {
        (L=2, 0.05772) (L=7, 0.06667) (L=1, 0.05525) (L=4, 0.06165) (L=3, 0.04952) (L=5, 0.04902) (L=8, 0.05581) (L=9, 0.05062) (L=6, 0.05372) (L=10, 0.04881) (L=13, 0.06007) (L=11, 0.07792) (L=15, 0.04) (L=14, 0.07857) (L=12, 0.07302) (L=16, 0.02292) (L=17, 0.0451) (L=20, 0.03833) (L=21, 0.03175) (L=19, 0.05965) (L=18, 0.0463) (L=23, 0.02899) (L=25, 0.04) (L=22, 0.07576) (L=26, 0.07692) (L=24, 0.10417)
      };
    \end{axis}
  \end{tikzpicture}
\end{figure}


Now after taking Every 5th letter from $ctx$ we get:
FZAQFXWPNKFIKEELMEEGDBTNPAXAHPPLVKITZTUEYBOGYOKXMNTZIMFMPGOAAXXIDDRKIKVDPQQHNRGDOSFMATGVTHMPKIXEAKRACLOEMAMHJXJUENGT

Now find the key by shifting cesar ciphers to reveal something meaningfu. We should see something in english. But that only means it
would work if the key is infact an english word. So I might not be able to tell if I have found the key or not unless I try evey key on
the chiphertext to reveal that $ctx'$ is something meaningful. Anyway, the answer is key lenght is 5 because statistically \\

\paragraph{Bonus Task}
As for the bonus, I don't think encrypting it twice would add exta security. But the added strenght only comes from the fact that it's
encrypted twice. If the offender expects chiphger text to be encrypted once but it's twice then there would be added benefit. But encrypting a
message using a Vigenere cipher with a
key of
length 3 and then encrypting the result  with a different key of length 5 would be the same as encrypting it once with 15-character key
lenght. Because for the keys 3,5 LCM is 15 and similar key can be formed. But eventually, when analyzed any keylenght will leak some
statistical probability. So it's not a bad idea to encrypt it twice but the benefit is marginal. Safest way would to be increase the key
size in general in proportion to the text size to avoid leakage.\\

\end{document}
